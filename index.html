<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Senior Operator Prep: V3.0 (Manager Edition)</title>
    <style>
        :root {
            --bg-dark: #0f172a;
            --panel: #1e293b;
            --text: #f8fafc;
            --text-gray: #94a3b8;
            --accent: #3b82f6; /* Blue */
            --success: #10b981; /* Green */
            --danger: #ef4444; /* Red */
            --warn: #f59e0b; /* Orange */
            --purple: #a855f7;
            --font-ui: 'Segoe UI', sans-serif;
            --font-code: 'Courier New', monospace;
        }

        body {
            background: var(--bg-dark); color: var(--text); font-family: var(--font-ui);
            margin: 0; height: 100vh; display: flex; flex-direction: column; overflow: hidden;
        }

        button { cursor: pointer; border: none; font-family: var(--font-ui); transition: 0.2s; outline: none; }
        button:active { transform: scale(0.98); }

        /* HEADER */
        header {
            background: #020617; padding: 15px 25px; border-bottom: 1px solid #334155;
            display: flex; justify-content: space-between; align-items: center;
        }
        .brand { font-size: 1.2rem; font-weight: bold; display: flex; align-items: center; gap: 10px; }
        .brand span { background: var(--warn); color: #000; font-size: 0.7rem; padding: 2px 6px; border-radius: 4px; font-weight: 800; letter-spacing: 1px;}
        .nav-group { display: flex; gap: 10px; }
        .nav-btn { background: transparent; color: var(--text-gray); border: 1px solid #334155; padding: 8px 15px; border-radius: 6px; font-weight: 600; }
        .nav-btn:hover { background: #334155; color: #fff; }
        .nav-btn.active { background: var(--accent); color: #fff; border-color: var(--accent); }

        /* SCREENS */
        .screen { display: none; height: 100%; overflow-y: auto; padding: 20px; animation: fade 0.3s; }
        .screen.active { display: flex; flex-direction: column; }
        @keyframes fade { from { opacity: 0; } to { opacity: 1; } }

        /* KNOWLEDGE HUB */
        .k-container { max-width: 1200px; margin: 0 auto; width: 100%; padding-bottom: 50px; }
        .k-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top:20px; }
        .k-card { background: var(--panel); border: 1px solid #334155; border-radius: 12px; padding: 25px; border-left: 5px solid; transition:0.3s; }
        .k-card:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .k-head { font-size: 1.2rem; font-weight: bold; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .k-body { line-height: 1.7; color: var(--text-gray); font-size: 0.95rem; }
        .tag { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-right: 5px; color:#000; }

        /* ANSWER KEY STYLES */
        .ans-cat { margin-bottom: 30px; border: 1px solid #334155; border-radius: 12px; overflow: hidden; }
        .ans-cat-header { background: #1e293b; padding: 15px 25px; font-size: 1.5rem; font-weight: bold; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .ans-cat-header:hover { background: #2d3e50; }
        .ans-list { display: none; padding: 15px; background: #0f172a; }
        .ans-item { margin-bottom: 20px; padding: 15px; border-left: 4px solid var(--accent); background: #1e293b; border-radius: 0 8px 8px 0; }
        .ans-id { font-weight: bold; color: var(--warn); margin-bottom: 5px; font-family: var(--font-code); }
        .ans-title { font-size: 1.1rem; font-weight: bold; margin-bottom: 10px; color: #fff; }
        .ans-detail { font-size: 0.95rem; line-height: 1.6; color: var(--text-gray); }
        .root-highlight { color: var(--success); font-weight: bold; margin-top: 5px; display: block; }

        /* MISSION BOARD */
        .mission-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 1000px; margin: 30px auto; width: 100%; }
        .m-card { 
            background: var(--panel); border: 1px solid #334155; border-radius: 12px; padding: 25px; 
            text-align: left; position: relative; transition: 0.2s; cursor: pointer;
        }
        .m-card:hover { transform: translateY(-5px); border-color: var(--accent); box-shadow: 0 10px 20px rgba(0,0,0,0.4); }
        .m-icon { font-size: 2rem; margin-bottom: 10px; display: block; }
        .m-head { font-size: 1.1rem; font-weight: bold; color: #fff; }
        .m-sub { font-size: 0.85rem; color: var(--text-gray); margin-top: 5px; }
        .badge-count { position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.1); padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; }

        /* SIMULATOR */
        #sim-layout { display: grid; grid-template-columns: 1fr 380px; gap: 20px; height: 100%; max-width: 1600px; margin: 0 auto; width: 100%; }
        .work-area { overflow-y: auto; padding-right: 15px; display: flex; flex-direction: column; gap: 20px; padding-bottom: 80px;}
        
        .scenario-box {
            background: linear-gradient(145deg, #1e293b, #0f172a);
            border: 1px solid var(--accent); border-radius: 8px; padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2); position: relative;
        }
        .difficulty { position: absolute; top: 20px; right: 20px; font-size: 0.8rem; color: var(--warn); border: 1px solid var(--warn); padding: 2px 8px; border-radius: 4px; }
        
        .input-group label { display: flex; justify-content: space-between; margin-bottom: 8px; font-weight: bold; color: var(--text); font-size: 0.95rem; align-items: center; }
        .input-group textarea {
            width: 100%; background: #0b1120; border: 1px solid #334155; color: #fff;
            padding: 15px; border-radius: 6px; min-height: 90px; font-family: var(--font-ui); font-size: 1rem; resize: vertical; line-height: 1.5;
        }
        .input-group textarea:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3); }

        .btn-hint { background: #334155; color: #94a3b8; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; transition:0.2s; }
        .btn-hint:hover { background: #475569; color: #fff; }

        .btn-submit { background: var(--success); color: #020617; font-size: 1.2rem; padding: 18px; border-radius: 8px; font-weight: 800; margin-top: 10px; width: 100%; transition:0.3s; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); }
        .btn-submit:hover { filter: brightness(1.1); transform: translateY(-2px); }

        /* LIVE FEED */
        .sidebar { background: #0b1120; border-left: 1px solid #334155; display: flex; flex-direction: column; height: 100%; border-radius:8px 0 0 8px; overflow:hidden;}
        .feed-header { padding: 15px; background: #1e293b; border-bottom: 1px solid #334155; font-weight: bold; font-size: 0.9rem; color: #fff; display: flex; align-items: center; gap: 8px; }
        .blink { width: 8px; height: 8px; background: red; border-radius: 50%; box-shadow: 0 0 8px red; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.3; } }

        .feed-list { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .msg { padding: 12px 15px; border-radius: 8px; font-size: 0.9rem; animation: slideIn 0.3s; background: #1e293b; position: relative; border-left: 3px solid var(--text-gray); box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .msg.boss { border-left-color: var(--purple); background: #2e1065; } /* Boss/Pressure */
        .msg.tech { border-left-color: var(--warn); background: #451a03; } /* Tech/Trap */
        .msg.urgent { border-left-color: var(--danger); background: rgba(239, 68, 68, 0.1); border: 1px solid var(--danger); }
        .msg-sender { font-weight: bold; display: block; margin-bottom: 4px; font-size: 0.75rem; color: var(--accent); opacity: 0.8; }
        @keyframes slideIn { from { transform: translateX(20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        /* MODALS */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 200; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .res-box { background: var(--panel); width: 800px; max-width: 95%; padding: 40px; border-radius: 16px; border: 1px solid var(--success); max-height: 90vh; overflow-y: auto; box-shadow: 0 0 50px rgba(16, 185, 129, 0.2); }
        
        .score-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 30px 0; }
        .s-item { background: #0f172a; padding: 20px; border-radius: 10px; text-align: center; border: 1px solid #334155; }
        .s-val { font-size: 3rem; font-weight: bold; display: block; margin-top: 10px; }
        
        .feedback-area { background: #0b1120; padding: 25px; border-radius: 10px; font-family: var(--font-code); line-height: 1.6; border-left: 4px solid var(--warn); color: #cbd5e1; margin-bottom: 20px; white-space: pre-wrap; }
        .help-content { background: var(--panel); width: 600px; max-width: 90%; padding: 30px; border-radius: 12px; border: 1px solid var(--accent); position: relative; }
        .close-btn { position: absolute; top: 15px; right: 15px; background: transparent; color: #fff; font-size: 1.5rem; }

    </style>
</head>
<body>

    <header>
        <div class="brand">
            FACTORY SIM <span>V3.0 MANAGER</span>
        </div>
        
        <div style="display:flex; align-items:center; gap:20px;">
            <div id="timer" style="background:#0f172a; color:var(--warn); padding:8px 15px; border-radius:6px; font-family:var(--font-code); font-weight:bold; border:1px solid var(--warn); display:none; align-items:center; gap:5px;">
                ‚è±Ô∏è <span id="time-val">05:00</span>
            </div>

            <div class="nav-group">
                <button class="nav-btn" id="btn-know" onclick="showScreen('knowledge')">üìò Knowledge Hub</button>
                <button class="nav-btn" id="btn-ans" onclick="showScreen('answers')">üìñ Answer Key</button>
                <button class="nav-btn active" id="btn-home" onclick="showScreen('home')">üöÄ Mission Board</button>
            </div>
        </div>
    </header>

    <div id="scr-knowledge" class="screen">
        <div class="k-container">
            <div style="text-align:center; margin: 30px 0;">
                <h1 style="margin:0; font-size:2.5rem; color:var(--accent);">KNOWLEDGE HUB</h1>
                <p style="color:var(--text-gray);">‡∏Ñ‡∏•‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö Supervisor ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ</p>
            </div>

            <div class="k-grid">
                <div class="k-card" style="border-color:var(--purple);">
                    <div class="k-head" style="color:var(--purple);">1. 5 Whys Analysis (‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á)</div>
                    <div class="k-body">
                        ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡∏ñ‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡πÑ‡∏° ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡πÅ‡∏¢‡∏∞ <strong>Human Error</strong> vs <strong>System Error</strong>
                        <br><br>
                        <ul>
                            <li>‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏ô‡∏ú‡∏¥‡∏î -> ‡∏Ç‡∏≤‡∏î Skill? ‡∏Ç‡∏≤‡∏î Awareness? ‡∏´‡∏£‡∏∑‡∏≠ Fatigue?</li>
                            <li>‡∏ñ‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏¥‡∏î -> ‡∏Ç‡∏≤‡∏î Standard? ‡∏Ç‡∏≤‡∏î Tool? ‡∏´‡∏£‡∏∑‡∏≠ Design ‡∏ú‡∏¥‡∏î?</li>
                        </ul>
                    </div>
                </div>

                <div class="k-card" style="border-color:var(--danger);">
                    <div class="k-head" style="color:var(--danger);">2. Heinrich's Law (Safety)</div>
                    <div class="k-body">
                        ‡∏Å‡∏é 1 : 29 : 300
                        <br>
                        ‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ 29 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏ (Near Miss) 300 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                        <br><br>
                        <span class="tag" style="background:var(--danger);">Lesson</span> ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Near Miss ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏´‡∏ç‡πà
                  </div>
                </div>

                <div class="k-card" style="border-color:var(--success);">
                    <div class="k-head" style="color:var(--success);">3. HACCP & CCP Management</div>
                    <div class="k-body">
                        <strong>CCP (Critical Control Point):</strong> ‡∏à‡∏∏‡∏î‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∏‡∏° 100% (‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏≠‡∏ö, ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÇ‡∏•‡∏´‡∏∞)
                        <br><br>
                        <span class="tag" style="background:var(--success);">Rule</span> ‡∏ñ‡πâ‡∏≤ CCP ‡∏´‡∏•‡∏∏‡∏î‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô = <strong>Product Unsafe</strong> (‡∏ï‡πâ‡∏≠‡∏á Hold/Reject ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏´‡πâ‡∏≤‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏á)
                    </div>
                </div>

                <div class="k-card" style="border-color:var(--warn);">
                    <div class="k-head" style="color:var(--warn);">4. PDCA Cycle (‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£)</div>
                    <div class="k-body">
                        <ul>
                            <li><strong>Plan:</strong> ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</li>
                            <li><strong>Do:</strong> ‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≥ (Immediate Action)</li>
                            <li><strong>Check:</strong> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏• (‡∏´‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏´‡∏°?)</li>
                            <li><strong>Act:</strong> ‡∏ß‡∏≤‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà (Preventive Action)</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div style="text-align:center; margin-top:40px;">
                <button class="btn-submit" style="width:auto; padding:15px 50px;" onclick="showScreen('home')">‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ó‡∏§‡∏©‡∏é‡∏µ‡πÅ‡∏•‡πâ‡∏ß ‚û°Ô∏è ‡πÑ‡∏õ‡∏•‡∏∏‡∏¢‡∏™‡∏ô‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á</button>
            </div>
        </div>
    </div>

    <div id="scr-answers" class="screen">
        <div class="k-container">
            <h1 style="text-align:center; color:var(--warn);">üìñ Answer Key & 5 Whys Concept</h1>
            <p style="text-align:center; color:var(--text-gray); margin-bottom:30px;">‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏≤‡∏Å‡πÄ‡∏´‡∏á‡πâ‡∏≤‡∏õ‡∏±‡∏ç‡∏´‡∏≤ (Root Cause Analysis)</p>
            <div id="ans-accordion-container"></div>
        </div>
    </div>

    <div id="scr-home" class="screen active">
        <div style="text-align:center; margin: 40px 0;">
            <h1 style="margin:0; font-size:3rem; text-shadow: 0 0 20px rgba(59, 130, 246, 0.3);">MISSION CONTROL</h1>
            <p style="color:var(--text-gray); font-size:1.2rem;">‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏à‡∏£‡∏¥‡∏á: Lotus Bakery Simulation</p>
        </div>

        <div class="mission-grid">
            <div class="m-card" style="border-top:4px solid var(--purple)" onclick="startSim('man')">
                <span class="badge-count">6 Scenarios</span>
                <span class="m-icon">üë∑‚Äç‚ôÇÔ∏è</span><div class="m-head">MAN (‡∏Ñ‡∏ô)</div><div class="m-sub">‡∏ß‡∏¥‡∏ô‡∏±‡∏¢, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏±‡∏î‡πÅ‡∏¢‡πâ‡∏á, ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</div>
            </div>
            <div class="m-card" style="border-top:4px solid var(--accent)" onclick="startSim('machine')">
                <span class="badge-count">6 Scenarios</span>
                <span class="m-icon">‚öôÔ∏è</span><div class="m-head">MACHINE (‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£)</div><div class="m-sub">Breakdown, Sensor, OEE</div>
            </div>
            <div class="m-card" style="border-top:4px solid var(--warn)" onclick="startSim('method')">
                <span class="badge-count">5 Scenarios</span>
                <span class="m-icon">üìù</span><div class="m-head">METHOD (‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£)</div><div class="m-sub">SOP, Recipe, Document</div>
            </div>
            <div class="m-card" style="border-top:4px solid var(--danger)" onclick="startSim('material')">
                <span class="badge-count">5 Scenarios</span>
                <span class="m-icon">üì¶</span><div class="m-head">MATERIAL (‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö)</div><div class="m-sub">Allergen, Spec, Stock</div>
            </div>
            <div class="m-card" style="border-top:4px solid var(--success)" onclick="startSim('env')">
                <span class="badge-count">4 Scenarios</span>
                <span class="m-icon">üå°Ô∏è</span><div class="m-head">ENV (‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°)</div><div class="m-sub">Pest, Water, Temp</div>
            </div>
            <div class="m-card" style="background: linear-gradient(135deg, #1e293b, #334155); border: 2px solid #fff;" onclick="startSim('random')">
                <span class="badge-count">ALL</span>
                <span class="m-icon">üé≤</span><div class="m-head">RANDOM MODE</div><div class="m-sub">‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö Hardcore (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)</div>
            </div>
        </div>
    </div>

    <div id="scr-sim" class="screen">
        <div id="sim-layout">
            <div class="work-area">
                <div class="scenario-box">
                    <span class="difficulty" id="sc-diff">HARD</span>
                    <div style="display:flex; justify-content:space-between; margin-bottom:15px; align-items:center;">
                        <span class="sc-badge" id="sc-cat">CATEGORY</span>
                        <span style="font-size:0.8rem; color:#64748b;">ID: <span id="sc-id">001</span></span>
                    </div>
                    <div id="sc-title" style="font-size:1.6rem; font-weight:bold; color:#fff; margin-bottom:15px;">Title</div>
                    <div id="sc-desc" style="font-size:1.1rem; line-height:1.6; color:#cbd5e1; border-left:4px solid var(--accent); padding-left:15px; padding-top:5px; padding-bottom:5px; background:rgba(59,130,246,0.05);">Description</div>
                </div>

                <div class="input-group">
                    <label>
                        1. Root Cause Analysis (5 Whys / Fishbone)
                        <button class="btn-hint" onclick="openHelp('5why')">üí° Hint: 5 Whys</button>
                    </label>
                    <textarea id="inp-root" placeholder="‡∏ó‡∏≥‡πÑ‡∏° 1: ... ‡∏ó‡∏≥‡πÑ‡∏° 2: ... (‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏´‡πâ‡∏•‡∏∂‡∏Å‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö ‡∏≠‡∏¢‡πà‡∏≤‡πÇ‡∏ó‡∏©‡πÅ‡∏Ñ‡πà‡∏Ñ‡∏ô)"></textarea>
                </div>

                <div class="input-group">
                    <label>
                        2. Immediate Action (Decision Making)
                        <button class="btn-hint" onclick="openHelp('action')">üí° Hint: Decision</button>
                    </label>
                    <textarea id="inp-act" placeholder="‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£? (‡∏´‡∏¢‡∏∏‡∏î/‡∏ó‡∏≥‡∏ï‡πà‡∏≠) ‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏Ñ‡∏£? ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?"></textarea>
                </div>

                <div class="input-group">
                    <label>
                        3. Preventive Measure (System Improvement)
                    </label>
                    <textarea id="inp-prev" placeholder="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß: Training Plan / PM Checksheet / Poka-yoke / Visual Control"></textarea>
                </div>

                <button class="btn-submit" onclick="submitSim()">‚úÖ ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (SUBMIT REPORT)</button>
            </div>

            <div class="sidebar">
                <div class="feed-header">
                    <div class="blink"></div> LIVE INCIDENT FEED
                </div>
                <div class="feed-list" id="feed-box"></div>
            </div>
        </div>
    </header>

    <div id="modal-help" class="modal">
        <div class="help-content">
            <button class="close-btn" onclick="closeHelp()">&times;</button>
            <h3 id="m-title" style="margin-top:0; color:var(--accent); font-size:1.5rem;">Guide</h3>
            <div id="m-body" style="line-height:1.6; color:#cbd5e1; font-size:1rem;"></div>
        </div>
    </div>

    <div id="modal-result" class="modal">
        <div class="res-box">
            <h2 style="margin:0; color:var(--success); text-align:center; font-size:2rem;">ASSESSMENT RESULT</h2>
            <div class="score-grid">
                <div class="s-item">
                    <span style="color:#94a3b8; font-size:0.9rem; font-weight:bold;">LEADERSHIP</span>
                    <span class="s-val" id="sc-lead" style="color:var(--warn)">0</span>
                </div>
                <div class="s-item">
                    <span style="color:#94a3b8; font-size:0.9rem; font-weight:bold;">ANALYTICAL</span>
                    <span class="s-val" id="sc-anal" style="color:var(--accent)">0</span>
                </div>
                <div class="s-item">
                    <span style="color:#94a3b8; font-size:0.9rem; font-weight:bold;">PREVENTION</span>
                    <span class="s-val" id="sc-prev" style="color:var(--success)">0</span>
                </div>
            </div>
            
            <h3 style="color:#fff; margin-bottom:15px;">üë®‚Äçüè´ Mentor Feedback:</h3>
            <div class="feedback-area" id="res-fb"></div>
            
            <div style="text-align:center;">
                <button class="btn-submit" style="background:#334155; width:auto; padding:15px 40px;" onclick="nextScenario()">‚û°Ô∏è Scenario ‡∏ï‡πà‡∏≠‡πÑ‡∏õ</button>
            </div>
        </div>
    </div>

<script>
    // --- DATABASE ---
    const database = {
        man: [
            { 
                id: "MN-01", diff:"MED", title: "Operator ‡πÄ‡∏°‡∏≤‡∏™‡∏∏‡∏£‡∏≤", 
                desc: "‡πÑ‡∏î‡πâ‡∏Å‡∏•‡∏¥‡πà‡∏ô‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå‡∏à‡∏≤‡∏Å Operator ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Mixer ‡πÄ‡∏Ç‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ã‡πÅ‡∏•‡∏∞‡∏û‡∏π‡∏î‡∏à‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á", 
                events: [{t:2,u:"Lead",m:"‡πÄ‡∏°‡∏≤‡∏°‡∏≤‡∏ä‡∏±‡∏ß‡∏£‡πå‡∏û‡∏µ‡πà"},{t:10,u:"Safety",m:"‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö"}], 
                hint: "Zero Tolerance. ‡πÄ‡∏ä‡∏¥‡∏ç‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡πÄ‡∏°‡∏≤‡∏°‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏•‡∏ô‡πå<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ Pre-shift Check ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Fit to Work<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏ó‡∏≥ ‚Üí ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏ä‡πâ<br>‡∏ó‡∏≥‡πÑ‡∏° Zero Tolerance ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‚Üí ‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏¢‡∏≠‡∏°‡∏ú‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏ô",
                root: "‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡πÅ‡∏•‡∏∞ Fit-to-Work ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å enforce ‡∏à‡∏£‡∏¥‡∏á"
            },
            { 
                id: "MN-02", diff:"EASY", title: "‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏´‡∏°‡∏ß‡∏Å (GMP Violation)", 
                desc: "‡∏û‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ñ‡∏≠‡∏î‡∏´‡∏°‡∏ß‡∏Å‡∏Ñ‡∏•‡∏∏‡∏°‡∏ú‡∏° (Hairnet) ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞ '‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏£‡πâ‡∏≠‡∏ô'", 
                events: [{t:5,u:"QC",m:"‡πÄ‡∏à‡∏≠‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡∏°‡πÉ‡∏ô Product ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ï‡πâ‡∏≠‡∏á Hold ‡πÑ‡∏´‡∏°?"}], 
                hint: "Hold Product ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ + Coaching ‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà ‚Üí ‡∏£‡πâ‡∏≠‡∏ô ‡∏≠‡∏∂‡∏î‡∏≠‡∏±‡∏î<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏£‡πâ‡∏≠‡∏ô ‚Üí ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏¢‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏≥ ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ Visual Control / Supervisor ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏ß‡∏à<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏Å‡∏•‡∏±‡∏ß‡∏ú‡∏¥‡∏î ‚Üí ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©‡πÑ‡∏°‡πà‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠",
                root: "GMP Culture + Environment Design ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß"
            },
            { 
                id: "MN-03", diff:"HARD", title: "‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞‡∏ß‡∏¥‡∏ß‡∏≤‡∏ó‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏•‡∏ô‡πå", 
                desc: "‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏£‡∏à‡∏∏ 2 ‡∏Ñ‡∏ô‡∏ï‡∏∞‡πÇ‡∏Å‡∏ô‡∏î‡πà‡∏≤‡∏ó‡∏≠‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏±‡∏Å‡∏≠‡∏Å‡∏Å‡∏±‡∏ô ‡πÑ‡∏•‡∏ô‡πå‡∏ú‡∏•‡∏¥‡∏ï‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏∞‡∏á‡∏±‡∏Å", 
                events: [{t:2,u:"Sup",m:"‡πÄ‡∏Æ‡πâ‡∏¢! ‡∏ï‡πà‡∏≠‡∏¢‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏µ‡πà!"}], 
                hint: "‡πÅ‡∏¢‡∏Å‡∏Ñ‡∏π‡πà‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ -> ‡∏™‡∏≠‡∏ö‡∏™‡∏ß‡∏ô",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞ ‚Üí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏î‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏Å‡∏î‡∏î‡∏±‡∏ô ‚Üí ‡πÄ‡∏õ‡πâ‡∏≤‡∏ú‡∏•‡∏¥‡∏ï vs ‡∏Ñ‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏°‡∏î‡∏∏‡∏•<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ ‚Üí ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏±‡∏î‡πÅ‡∏¢‡πâ‡∏á<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Å‡∏•‡πâ‡∏≤ ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ Training ‡∏î‡πâ‡∏≤‡∏ô Leadership",
                root: "People Management System ‡∏≠‡πà‡∏≠‡∏ô"
            },
            { 
                id: "MN-04", diff:"MED", title: "‡πÅ‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏ö‡∏Å‡∏∞‡∏î‡∏∂‡∏Å (Fatigue)", 
                desc: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡πÑ‡∏•‡∏ô‡πå‡∏ï‡∏µ 2 ‡∏û‡∏ö Operator ‡∏´‡∏•‡∏±‡∏ö‡∏Ñ‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏°‡∏∏‡∏ô‡∏≠‡∏¢‡∏π‡πà", 
                events: [{t:5,u:"Safety",m:"‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏û‡∏µ‡πà"}], 
                hint: "‡∏õ‡∏•‡∏∏‡∏Å‡πÅ‡∏•‡∏∞‡πÅ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡∏´‡∏•‡∏±‡∏ö ‚Üí Fatigue<br>‡∏ó‡∏≥‡πÑ‡∏° Fatigue ‚Üí ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏±‡∏ö ‚Üí ‡∏Ç‡∏≤‡∏î Fatigue Risk Assessment<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏ó‡∏≥ ‚Üí ‡∏°‡∏≠‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß",
                root: "‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Å‡∏∞ & ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ"
            },
            { 
                id: "MN-05", diff:"HARD", title: "‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏≥‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏¢‡∏≠‡∏∞", 
                desc: "‡∏ô‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏Ñ‡∏∏‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡πà‡∏≠ ‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏û‡∏∏‡πà‡∏á 20% (‡∏õ‡∏Å‡∏ï‡∏¥ 2%)", 
                events: [{t:10,u:"Tech",m:"‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ô‡πâ‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏á"}], 
                hint: "Stop ‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠ OJT ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡πà‡∏á‡∏û‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏ö",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡πÄ‡∏™‡∏µ‡∏¢ ‚Üí ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô ‚Üí Training ‡πÑ‡∏°‡πà‡∏û‡∏≠<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏õ‡∏•‡πà‡∏≠‡∏¢ ‚Üí ‡∏Ç‡∏≤‡∏î OJT / Buddy<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏£‡∏µ‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‚Üí ‡∏Ç‡∏≤‡∏î Manpower Plan",
                root: "Training & Skill Assurance System ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß"
            },
            { 
                id: "MN-06", diff:"MED", title: "‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏•‡∏ô‡πå‡∏™‡∏±‡πà‡∏á‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô", 
                desc: "‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏•‡∏ô‡πå‡∏™‡∏±‡πà‡∏á‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å QC ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ '‡∏£‡∏µ‡∏ö'", 
                events: [{t:5,u:"Op",m:"‡∏û‡∏µ‡πà‡πÄ‡∏Ç‡∏≤‡∏ö‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏î‡∏Ñ‡∏£‡∏±‡∏ö"}], 
                hint: "Quality Integrity ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏ß‡πà‡∏≤‡∏¢‡∏≠‡∏î‡∏ú‡∏•‡∏¥‡∏ï ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏∏‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡∏Ç‡πâ‡∏≤‡∏° ‚Üí ‡∏£‡∏µ‡∏ö‡∏¢‡∏≠‡∏î<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏Å‡∏•‡πâ‡∏≤‡∏™‡∏±‡πà‡∏á ‚Üí KPI ‡πÄ‡∏ô‡πâ‡∏ô Output ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡∏Ñ‡πâ‡∏≤‡∏ô ‚Üí Authority QA ‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏ó‡∏≥‡∏ã‡πâ‡∏≥ ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ Consequence",
                root: "KPI & Governance ‡∏ú‡∏¥‡∏î‡∏ó‡∏¥‡∏®"
            }
        ],
        machine: [
            { 
                id: "MC-01", diff:"HARD", title: "‡πÄ‡∏®‡∏©‡πÅ‡∏Å‡πâ‡∏ß‡πÅ‡∏ï‡∏Å (Glass Breakage)", 
                desc: "‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏™‡∏≤‡∏¢‡∏û‡∏≤‡∏ô‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡πÅ‡∏ï‡∏Å‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡πÄ‡∏®‡∏©‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏•‡∏á‡πÑ‡∏•‡∏ô‡πå‡∏ú‡∏•‡∏¥‡∏ï", 
                events: [{t:2,u:"Op",m:"‡πÅ‡∏ï‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏µ‡πà! ‡πÄ‡∏®‡∏©‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏•‡∏¢!"}], 
                hint: "Critical Safety! ‡∏´‡∏¢‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡πÅ‡∏Å‡πâ‡∏ß‡πÅ‡∏ï‡∏Å ‚Üí ‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü‡πÅ‡∏ï‡∏Å<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏≠‡∏î‡πÅ‡∏Å‡πâ‡∏ß ‚Üí Design ‡πÑ‡∏°‡πà Food Grade<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ Cover<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡∏π‡πà ‚Üí Risk Assessment ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö",
                root: "Equipment Design ‡πÑ‡∏°‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á Food Safety"
            },
            { 
                id: "MC-02", diff:"MED", title: "Metal Detector False Reject", 
                desc: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÇ‡∏•‡∏´‡∏∞‡∏î‡∏µ‡∏î‡∏Ç‡∏≠‡∏á‡∏ó‡∏¥‡πâ‡∏á‡∏£‡∏±‡∏ß‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏•‡∏´‡∏∞ ‡∏ä‡πà‡∏≤‡∏á‡∏Ç‡∏≠ Bypass", 
                events: [{t:5,u:"Tech",m:"Sensor ‡∏ä‡∏∑‡πâ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö ‡∏Ç‡∏≠ Bypass ‡πÅ‡∏õ‡πä‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß"}], 
                hint: "‡∏´‡πâ‡∏≤‡∏° Bypass CCP ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡πÅ‡∏ó‡∏ô 100%",
                whys: "‡∏ó‡∏≥‡πÑ‡∏° Reject ‚Üí Sensor ‡∏ä‡∏∑‡πâ‡∏ô<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏ä‡∏∑‡πâ‡∏ô ‚Üí Environment ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÑ‡∏°‡πà‡∏î‡∏µ<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏à‡∏∞ Bypass ‚Üí Pressure ‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤ Bypass ‡πÑ‡∏î‡πâ ‚Üí CCP Awareness ‡∏ï‡πà‡∏≥",
                root: "CCP Governance & Awareness Fail"
            },
            { 
                id: "MC-03", diff:"HARD", title: "‡πÄ‡∏ï‡∏≤‡∏≠‡∏ö‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡∏Å", 
                desc: "‡∏Å‡∏£‡∏≤‡∏ü‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ Zone 3 ‡∏ï‡∏Å‡∏ß‡∏π‡∏ö ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏™‡∏µ‡∏ã‡∏µ‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏™‡∏∏‡∏Å", 
                events: [{t:10,u:"QC",m:"‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡πÅ‡∏â‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤"}], 
                hint: "Hold ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏Å‡∏ô‡∏Å‡∏•‡∏≤‡∏á",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏™‡∏∏‡∏Å ‚Üí Temp ‡∏ï‡∏Å<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡∏Å ‚Üí Heater/Control Fail<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà detect ‡πÄ‡∏£‡πá‡∏ß ‚Üí Monitoring ‡πÑ‡∏°‡πà Real-time<br>‡∏ó‡∏≥‡πÑ‡∏°‡∏¢‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï ‚Üí Pressure ‡∏à‡∏≤‡∏Å Sale",
                root: "CCP Monitoring & Escalation Fail"
            },
            { 
                id: "MC-04", diff:"MED", title: "‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏´‡∏¢‡∏î", 
                desc: "‡∏û‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏™‡∏µ‡∏î‡∏≥‡∏´‡∏¢‡∏î‡∏à‡∏≤‡∏Å‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏•‡∏á‡∏ö‡∏ô‡∏™‡∏≤‡∏¢‡∏û‡∏≤‡∏ô‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡πÅ‡∏õ‡πâ‡∏á", 
                events: [{t:5,u:"Op",m:"‡∏û‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡∏ö ‡πÅ‡∏õ‡πâ‡∏á‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô!"}], 
                hint: "Contamination! ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ã‡∏µ‡∏•",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô ‚Üí Seal ‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏° ‚Üí PM ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡πà‡∏≠‡∏ô ‚Üí PM Checklist ‡πÑ‡∏°‡πà‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÉ‡∏ä‡πâ Oil ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ ‚Üí Spec ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö",
                root: "PM + Lubrication Standard ‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î"
            },
            { 
                id: "MC-05", diff:"EASY", title: "‡∏™‡∏≤‡∏¢‡∏û‡∏≤‡∏ô‡∏Ç‡∏≤‡∏î", 
                desc: "‡∏™‡∏≤‡∏¢‡∏û‡∏≤‡∏ô‡∏•‡∏≥‡πÄ‡∏•‡∏µ‡∏¢‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≤‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô ‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏∞‡∏á‡∏±‡∏Å", 
                events: [{t:5,u:"Tech",m:"‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏Ñ‡∏£‡∏±‡∏ö‡∏û‡∏µ‡πà"}], 
                hint: "‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Spare Parts ‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á‡∏î‡πà‡∏ß‡∏ô",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡∏Ç‡∏≤‡∏î ‚Üí ‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà ‚Üí Stock ‡πÑ‡∏°‡πà‡∏û‡∏≠<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà Stock ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ Critical Spare List<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô ‚Üí Maintenance ‡πÑ‡∏°‡πà‡∏£‡πà‡∏ß‡∏° Plan",
                root: "Spare Part Strategy ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß"
            },
            { 
                id: "MC-06", diff:"HARD", title: "E-Stop ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô", 
                desc: "‡∏ó‡∏î‡∏™‡∏≠‡∏ö Safety ‡∏û‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î", 
                events: [{t:5,u:"Safety",m:"‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î"}], 
                hint: "Safety Violation! ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
                whys: "‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î ‚Üí Switch Fail<br>‡∏ó‡∏≥‡πÑ‡∏° Fail ‚Üí ‡πÑ‡∏°‡πà‡∏ó‡∏î‡∏™‡∏≠‡∏ö<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‚Üí PM ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏° Safety<br>‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö ‚Üí Safety Audit ‡∏≠‡πà‡∏≠‡∏ô",
                root: "Safety System Governance ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß"
            }
        ],
        method: [
            { 
                id: "MT-01", diff:"MED", title: "‡∏™‡∏π‡∏ï‡∏£‡∏ú‡∏¥‡∏î", 
                desc: "‡πÉ‡∏ä‡πâ‡πÉ‡∏ö‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏Å‡πà‡∏≤‡∏ú‡∏™‡∏°‡πÅ‡∏õ‡πâ‡∏á", 
                hint: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Document Version Control",
                root: "Document Control System ‡∏•‡πâ‡∏°"
            },
            { 
                id: "MT-02", diff:"HARD", title: "‡∏•‡πâ‡∏≤‡∏á‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏≠‡∏≤‡∏î (Allergen)", 
                desc: "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡∏ñ‡∏±‡πà‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏° ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÄ‡∏à‡∏≠‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡∏ñ‡∏±‡πà‡∏ß", 
                hint: "Critical! ‡∏´‡πâ‡∏≤‡∏°‡∏£‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞ Swab ‡∏ú‡πà‡∏≤‡∏ô",
                root: "Allergen Management & Validation Fail"
            },
            { id: "MT-03", diff:"MED", title: "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≤‡∏î", desc: "‡∏Ç‡∏≠‡∏á‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏ñ‡∏∏‡∏á‡∏•‡∏∞ 5g", root: "Calibration & Process Capability ‡πÑ‡∏°‡πà‡∏û‡∏≠" },
            { id: "MT-04", diff:"EASY", title: "‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏ú‡∏¥‡∏î", desc: "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á 1 ‡∏õ‡∏µ", root: "Label Control & Verification Step ‡∏Ç‡∏≤‡∏î" },
            { id: "MT-05", diff:"HARD", title: "‡∏Ç‡πâ‡∏≤‡∏° Metal Check", desc: "‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏´‡∏¢‡∏¥‡∏ö‡∏Ç‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", root: "Process Discipline + Layout Design Fail" }
        ],
        material: [
            { id: "MR-01", diff:"MED", title: "‡∏°‡∏≠‡∏î‡πÉ‡∏ô‡πÅ‡∏õ‡πâ‡∏á", desc: "‡πÄ‡∏ó‡πÅ‡∏õ‡πâ‡∏á‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏û‡∏ö‡πÅ‡∏°‡∏•‡∏á", root: "Supplier Approval & Incoming Control Fail" },
            { id: "MR-02", diff:"HARD", title: "‡∏ü‡∏¥‡∏•‡πå‡∏°‡∏ã‡∏µ‡∏•‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î", desc: "‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡∏£‡∏±‡πà‡∏ß", root: "Material Spec & Incoming Test ‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î" },
            { id: "MR-03", diff:"MED", title: "‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏", desc: "‡∏û‡∏ö‡πÑ‡∏Ç‡πà‡πÑ‡∏Å‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô Store", root: "FIFO System & Visual Control Fail" },
            { id: "MR-04", diff:"HARD", title: "‡πÄ‡∏®‡∏©‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å", desc: "‡πÄ‡∏à‡∏≠‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏õ‡∏ô‡πÉ‡∏ô‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•", root: "Packaging Integrity & Sieving System ‡πÑ‡∏°‡πà‡∏°‡∏µ" },
            { id: "MR-05", diff:"MED", title: "‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ö‡∏∏‡∏ö", desc: "‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏û‡∏≤‡πÄ‡∏•‡∏ó‡∏™‡∏π‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏•‡πà‡∏≤‡∏á‡∏¢‡∏∏‡∏ö", root: "Packaging Spec ‡πÑ‡∏°‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á Usage" }
        ],
        env: [
            { id: "EN-01", diff:"HARD", title: "‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏≤‡∏£‡∏±‡πà‡∏ß", desc: "‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏´‡∏¢‡∏î‡∏•‡∏á‡∏™‡∏≤‡∏¢‡∏û‡∏≤‡∏ô", root: "Facility Preventive Maintenance Fail" },
            { id: "EN-02", diff:"MED", title: "‡πÑ‡∏ü‡∏î‡∏±‡∏ö", desc: "‡πÑ‡∏ü‡∏î‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞ Gen ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô", root: "Business Continuity Plan ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö" },
            { id: "EN-03", diff:"HARD", title: "‡∏´‡∏ô‡∏π‡∏ß‡∏¥‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏•‡∏ô‡πå", desc: "‡∏û‡∏ö‡∏£‡πà‡∏≠‡∏á‡∏£‡∏≠‡∏¢‡∏´‡∏ô‡∏π‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï‡∏ú‡∏•‡∏¥‡∏ï", root: "Pest Control Program ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß" },
            { id: "EN-04", diff:"MED", title: "‡∏™‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ‡∏´‡∏Å", desc: "‡∏ñ‡∏±‡∏á‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡∏ô‡∏£‡∏±‡πà‡∏ß‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏™‡∏°", root: "Chemical Storage & Emergency Response Training ‡πÑ‡∏°‡πà‡∏û‡∏≠" }
        ]
    };

    // --- SYSTEM LOGIC ---
    let currentSc = null;
    let timerInt, feedInt;
    let timeLeft = 300;

    function showScreen(id) {
        // Correctly handle nav buttons and screens
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        const target = document.getElementById('scr-' + id);
        if(target) target.classList.add('active');
        
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        if(id === 'knowledge') document.getElementById('btn-know').classList.add('active');
        else if(id === 'answers') document.getElementById('btn-ans').classList.add('active');
        else document.getElementById('btn-home').classList.add('active');

        if(id !== 'sim') {
            document.getElementById('timer').style.display = 'none';
            stopSim();
        }

        if(id === 'answers') renderAnswerKey();
    }

    function renderAnswerKey() {
        const container = document.getElementById('ans-accordion-container');
        if(!container) return;
        container.innerHTML = '';
        
        const cats = {
            man: { label: "üß† MAN (‡∏Ñ‡∏ô)", color: "var(--purple)" },
            machine: { label: "‚öôÔ∏è MACHINE (‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£)", color: "var(--accent)" },
            method: { label: "üìù METHOD (‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£)", color: "var(--warn)" },
            material: { label: "üì¶ MATERIAL (‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö)", color: "var(--danger)" },
            env: { label: "üå°Ô∏è ENV (‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°)", color: "var(--success)" }
        };

        for (let key in cats) {
            const catDiv = document.createElement('div');
            catDiv.className = 'ans-cat';
            
            const header = document.createElement('div');
            header.className = 'ans-cat-header';
            header.style.borderLeft = `6px solid ${cats[key].color}`;
            header.innerHTML = `<span>${cats[key].label}</span> <span>‚ñº</span>`;
            
            const list = document.createElement('div');
            list.className = 'ans-list';
            
            database[key].forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'ans-item';
                itemDiv.innerHTML = `
                    <div class="ans-id">${item.id}</div>
                    <div class="ans-title">${item.title}</div>
                    <div class="ans-detail">
                        ${item.whys ? `<b>5 Whys (‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î):</b><br>${item.whys}<br>` : ''}
                        <span class="root-highlight">Root Cause ‚Üí ${item.root}</span>
                    </div>
                `;
                list.appendChild(itemDiv);
            });

            header.onclick = () => {
                const isOpen = list.style.display === 'block';
                list.style.display = isOpen ? 'none' : 'block';
                header.querySelector('span:last-child').innerText = isOpen ? '‚ñº' : '‚ñ≤';
            };

            catDiv.appendChild(header);
            catDiv.appendChild(list);
            container.appendChild(catDiv);
        }
    }

    function startSim(cat) {
        showScreen('sim');
        let pool = [];
        if(cat === 'random') {
            Object.values(database).forEach(arr => pool.push(...arr));
        } else {
            pool = database[cat];
        }

        currentSc = pool[Math.floor(Math.random() * pool.length)];
        
        document.getElementById('sc-cat').innerText = cat.toUpperCase();
        document.getElementById('sc-id').innerText = currentSc.id;
        document.getElementById('sc-diff').innerText = currentSc.diff || "MED";
        document.getElementById('sc-title').innerText = currentSc.title;
        document.getElementById('sc-desc').innerText = currentSc.desc;
        
        ['inp-root', 'inp-act', 'inp-prev'].forEach(id => document.getElementById(id).value = '');
        document.getElementById('feed-box').innerHTML = '';

        timeLeft = 300;
        document.getElementById('timer').style.display = 'flex';
        updateTimer();
        
        clearInterval(timerInt);
        timerInt = setInterval(() => {
            timeLeft--;
            updateTimer();
            if(timeLeft <= 0) submitSim();
        }, 1000);

        clearInterval(feedInt);
        const startT = Date.now();
        addMsg('SYSTEM', 'Incident Detected. Logging started...', false, '');
        
        feedInt = setInterval(() => {
            const elap = Math.floor((Date.now() - startT)/1000);
            if(currentSc && currentSc.events) {
                currentSc.events.forEach(ev => {
                    if(ev.t === elap) addMsg(ev.u, ev.m, true, 'urgent');
                });
            }
        }, 1000);
    }

    function stopSim() {
        clearInterval(timerInt);
        clearInterval(feedInt);
    }

    function updateTimer() {
        const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
        const s = (timeLeft % 60).toString().padStart(2, '0');
        document.getElementById('time-val').innerText = `${m}:${s}`;
    }

    function addMsg(sender, msg, isUrgent, type) {
        const d = document.createElement('div');
        d.className = `msg ${type || ''}`;
        d.innerHTML = `<span class="msg-sender">${sender}</span>${msg}`;
        const box = document.getElementById('feed-box');
        if(box) {
            box.appendChild(d);
            box.scrollTop = box.scrollHeight;
        }
    }

    function openHelp(type) {
        const m = document.getElementById('modal-help');
        if(!m) return;
        m.style.display = 'flex';
        const title = document.getElementById('m-title');
        const body = document.getElementById('m-body');
        title.innerText = type === '5why' ? "üîç Hint: 5 Whys" : "‚ö° Hint: Decision";
        body.innerHTML = type === '5why' ? 
            "‡∏•‡∏≠‡∏á‡∏ô‡∏∂‡∏Å‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö: ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏±‡∏ö‡πÑ‡∏´‡∏°? ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡πÑ‡∏´‡∏°? ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡πÑ‡∏´‡∏°?" : 
            "Action ‡∏´‡∏•‡∏±‡∏Å: <br>1. ‡∏´‡∏¢‡∏∏‡∏î (Stop) <br>2. ‡∏≠‡∏≤‡∏¢‡∏±‡∏î (Hold) <br>3. ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (Report)";
    }

    function closeHelp() { 
        const m = document.getElementById('modal-help');
        if(m) m.style.display = 'none'; 
    }

    function submitSim() {
        stopSim();
        const root = document.getElementById('inp-root').value.toLowerCase();
        const act = document.getElementById('inp-act').value.toLowerCase();
        
        let sLead = act.includes('‡∏´‡∏¢‡∏∏‡∏î') || act.includes('hold') || act.includes('‡∏≠‡∏≤‡∏¢‡∏±‡∏î') ? 9 : 5;
        let sAnal = root.length > 20 ? 8 : 4;
        let sPrev = 7;

        document.getElementById('sc-lead').innerText = sLead;
        document.getElementById('sc-anal').innerText = sAnal;
        document.getElementById('sc-prev').innerText = sPrev;
        
        let feedbackText = sLead > 7 ? "‚úÖ ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" : "‚ö†Ô∏è ‡∏£‡∏∞‡∏ß‡∏±‡∏á! ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï";
        document.getElementById('res-fb').innerHTML = `${feedbackText}<br><br><b style='color:var(--warn)'>‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:</b><br>${currentSc ? currentSc.root : ''}`;

        document.getElementById('modal-result').style.display = 'flex';
    }

    function nextScenario() {
        document.getElementById('modal-result').style.display = 'none';
        showScreen('home');
    }
</script>
</body>
</html>